---
class: content
---

<div class="doc-header">
  <h1>TextFieldを数字のみだけでなく、小数点も使えるようにする方法</h1>
  <div class="doc-author">いせりゅー</div>
</div>

# TextField を数字のみだけでなく、小数点も使えるようにする方法

## 本題

こんにちは。いせりゅーです。
Flutter において、誰でも１度は見たのあるTextFieldについての内容となっております。TextFieldの UI 関連などについての記事はいくつかありましたが、「数字のみ」かつ「小数点は 2 文字目以降の入力ができる」という実装の記事が見つからなかったので、実装してみました。

## 数字のみの制限にする

数字のみの制限をするのはとても簡単に作ることができます。たった 2 行で実装することができます。

```dart
TextField(
  // 数値のキーボードが表示される
  keyboardType: TextInputType.number,
  // コピペなどで数字以外の入力を防ぐ
  inputFormatters: [FilteringTextInputFormatter.digitsOnly]
),
```

上のコードで実装自体は、70％ぐらいできましたが、「小数点は 2 文字目以降の入力ができる」という実装はまだできていません。
現状だと、数字のみの入力になるため、小数点は入力できません。

<hr class="page-break"/>

小数点を入力できるようにするには以下の考え方が必要になります。

- 最初の 1 行目は小数点を入力できないようにする
  - 例）.01 や.10 は 今回の実装としては、入力できないようにしたい。
- 2 文字以降は自由に使えるようにしたい。
- 小数点は、1 回までの入力にしたい
  - 例）1.01.0 や 1.0.0.1.3...4 などは変換するうえで不正な値になるから避けたい。

では実装した内容をご紹介します。

```dart
TextField(
  keyboardType: TextInputType.numberWithOptions(decimal: true),
  inputFormatters: <TextInputFormatter>[
    // 先頭が数字で始まる
    // 数字の後には、0個以上の小数点とそれに続く数字が続く
    FilteringTextInputFormatter.allow(RegExp(r'^\d+(\.\d*)?')),
  ],
)
```

## 最後に

今回、参考になる記事が見つからなかったときに、いろいろと試行錯誤を練ることはとてもいいなと思いました。考え方さえ理解してしまえば、ChatGPT と協力すれば実装できる気がしています。今回の一番の収穫は、考え方を自分なりにまとめられたことだと思います。このいい発見を今後も実感できるといいなと思います！！
